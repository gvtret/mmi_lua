local Icons = {
  ['EMPTY'] = {
    ['h'] = 11, 
    ['w'] = 16,
    ['data'] = string.char(0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00)
  },
  ['TEL'] = {
    ['h'] = 11, 
    ['w'] = 16,
    ['data'] = string.char(0x01,0xFC,0x00,0x0E,0x00,0x03,0x3F,0xFB,0x04,0x89,0x89,0xD1,0x89,0x11,0x9F,0xFC,0xC0,0x00,0x70,0x00,0x3F,0x80)
  },
  ['WRENCH'] = {
    ['h'] = 11, 
    ['w'] = 16,
    ['data'] = string.char(0x00,0x24,0x00,0x66,0x00,0x66,0x00,0x7E,0x00,0x3C,0x00,0x18,0x00,0x18,0x00,0x18,0x00,0x18,0x00,0x18,0x00,0x18)
  },
  ['WRENCH_EXCLAMATION'] = {
    ['h'] = 11, 
    ['w'] = 16,
    ['data'] = string.char(0x08,0x24,0x1C,0x66,0x1C,0x66,0x1C,0x7E,0x08,0x3C,0x00,0x18,0x08,0x18,0x1C,0x18,0x08,0x18,0x00,0x18,0x00,0x18)
  },
  ['MAGNIFIER'] = {
    ['h'] = 11, 
    ['w'] = 16,
    ['data'] = string.char(0x07,0xC0,0x08,0x20,0x0A,0xA0,0x09,0x20,0x0A,0xA0,0x08,0x20,0x07,0xE0,0x00,0x18,0x00,0x0C,0x00,0x06,0x00,0x03)
  },
  ['DOOR'] = {
    ['h'] = 11, 
    ['w'] = 16,
    ['data'] = string.char(0x3F,0xC0,0x30,0x44,0x38,0x48,0x3C,0x5F,0x3C,0x48,0x3C,0x44,0x3C,0x40,0x7F,0xE0,0x1C,0x00,0x0C,0x00,0x04,0x00)
  },
  ['PUSHBUTTON'] = {
    ['h'] = 11, 
    ['w'] = 16,
    ['data'] = string.char(0x00,0x80,0x02,0xA0,0x01,0xC0,0x00,0x80,0x00,0x00,0x07,0xF0,0x0C,0x18,0x2C,0x1A,0x4B,0xE9,0x48,0x09,0x27,0xF2)
  },
  ['TABLE'] = {
    ['h'] = 11, 
    ['w'] = 16,
    ['data'] = string.char(0x1F,0xFF,0x11,0x11,0x11,0x11,0x1F,0xFF,0x11,0x11,0x11,0x11,0x1F,0xFF,0x11,0x11,0x11,0x11,0x1F,0xFF,0x00,0x00)
  },
  ['SYMLR'] = {
    ['h'] = 11, 
    ['w'] = 16,
    ['data'] = string.char(0x00,0x00,0x04,0x10,0x0C,0x18,0x1C,0x1C,0x3C, 0x1E,0x7C,0x1F,0x3C,0x1E,0x1C,0x1C,0x0C,0x18,0x04,0x10,0x00,0x00)  
  }
}

local Control = require('cpmlib.Control')
local Icon = class (Control)

function Icon:init(attrs)
  Control.init(self, attrs)
  self._funcId = 0x02
  self._h = self._h or Icons.EMPTY.h
  self._w = self._w or Icons.EMPTY.w
  self._data = Icons.EMPTY.data
  self:draw()
end

function Icon:setType(name)
  if name == nil or name == '' then return end
  if Icons[name] == nil then return end
  self._h = Icons[name].h
  self._w = Icons[name].w
  self._data = Icons[name].data
  self:draw()
end

function Icon:draw()
  self._buffer = struct.pack('BBBBHH',
                              self._funcId,
                              bit32.bor(bit32.lshift(self._bg,4), self._fg),
                              self._h,
                              self._w,
                              self._l,
                              self._t)
  self._buffer = self._buffer..self._data
end

return Icon